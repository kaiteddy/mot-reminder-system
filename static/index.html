<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI MOT Assistant - Intelligent Vehicle Management</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-md-2 sidebar">
                <div class="sidebar-header">
                    <h2><i class="fas fa-robot"></i> AI MOT Assistant</h2>
                </div>
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link active" href="#" data-page="dashboard">
                            <i class="fas fa-chart-line"></i> AI Dashboard
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="vehicles">
                            <i class="fas fa-car"></i> Smart Fleet
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="customers">
                            <i class="fas fa-users"></i> Customer Hub
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="reminders">
                            <i class="fas fa-brain"></i> AI Reminders
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="job-sheets">
                            <i class="fas fa-file-invoice"></i> GA4 Job Sheets
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-page="settings">
                            <i class="fas fa-cogs"></i> Neural Config
                        </a>
                    </li>
                </ul>
            </div>

            <!-- Main Content -->
            <div class="col-md-10 main-content">
                <!-- Dashboard Page -->
                <div class="page" id="dashboard-page">
                    <!-- AI Assistant Header -->
                    <div class="ai-header">
                        <div class="ai-header-content">
                            <div class="ai-avatar">
                                <i class="fas fa-robot"></i>
                            </div>
                            <div class="ai-text">
                                <h3>AI MOT Intelligence Center</h3>
                                <p>Advanced vehicle monitoring and predictive maintenance insights</p>
                            </div>
                        </div>
                    </div>

                    <!-- AI Insights Card -->
                    <div class="ai-insight-card">
                        <div class="ai-insight-title">
                            <i class="fas fa-lightbulb"></i>
                            AI Insights & Recommendations
                        </div>
                        <div class="ai-insight-content">
                            <div class="ai-recommendation">
                                <strong>üéØ Smart Recommendation:</strong> 15 vehicles require immediate attention. AI suggests prioritizing overdue MOTs first to maximize customer satisfaction.
                            </div>
                            <div class="ai-warning">
                                <strong>‚ö†Ô∏è Predictive Alert:</strong> Based on historical data, expect 23% increase in MOT bookings next week. Consider adjusting staff schedules.
                            </div>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-md-4">
                            <div class="stat-card hover-glow">
                                <div class="stat-number" id="reminders-due-count">0</div>
                                <div class="stat-label">
                                    <i class="fas fa-brain"></i> AI Predictions
                                </div>
                                <button class="btn btn-primary mt-3" id="process-reminders-btn">
                                    <i class="fas fa-magic"></i> Process with AI
                                </button>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stat-card hover-glow">
                                <div class="stat-number" id="vehicles-count">0</div>
                                <div class="stat-label">
                                    <i class="fas fa-car"></i> Smart Fleet
                                </div>
                                <button class="btn btn-primary mt-3" id="schedule-reminders-btn">
                                    <i class="fas fa-calendar-alt"></i> Auto Schedule
                                </button>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stat-card hover-glow">
                                <div class="stat-number" id="customers-count">0</div>
                                <div class="stat-label">
                                    <i class="fas fa-users"></i> Customer Hub
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="text-gradient">
                                        <i class="fas fa-brain"></i> AI-Powered Reminder Intelligence
                                    </h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                <table class="table table-striped table-compact">
                                    <thead>
                                        <tr>
                                            <th>Registration</th>
                                            <th>Customer</th>
                                            <th>MOT Expiry</th>
                                            <th>Days Left</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="due-reminders-table">
                                        <!-- Reminders will be loaded here -->
                                    </tbody>
                                </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Vehicles Page -->
                <div class="page" id="vehicles-page" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center">
                        <h1>Vehicles</h1>
                        <div>
                            <button class="btn btn-outline-secondary me-2" id="upload-csv-btn">
                                <i class="bi bi-upload"></i> Upload File
                            </button>
                            <button class="btn btn-outline-danger me-2" id="clear-all-vehicles-btn">
                                <i class="bi bi-trash"></i> Clear All
                            </button>
                            <button class="btn btn-primary" id="add-vehicle-btn">
                                <i class="bi bi-plus"></i> Add Vehicle
                            </button>
                        </div>
                    </div>

                    <!-- CSV Upload Section -->
                    <div class="row mt-3" id="csv-upload-section" style="display: none;">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5>Upload Vehicle File (CSV/Excel)</h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <input type="file" class="form-control" id="csv-file-input" accept=".csv,.xlsx,.xls">
                                        <div class="form-text">
                                            <strong>Enhanced File Upload with DVLA Auto-Lookup:</strong><br>
                                            ‚Ä¢ <strong>Supported formats:</strong> CSV (.csv) and Excel (.xlsx, .xls)<br>
                                            ‚Ä¢ <strong>Required:</strong> registration<br>
                                            ‚Ä¢ <strong>Optional:</strong> make, model, color, year, mot_expiry, customer_name, customer_email, customer_phone<br>
                                            ‚Ä¢ System will automatically lookup and verify all registrations against DVLA database<br>
                                            ‚Ä¢ DVLA data takes precedence over file data for accuracy<br>
                                            ‚Ä¢ Missing vehicle details will be auto-populated from DVLA
                                        </div>
                                    </div>
                                    <div class="d-flex gap-2">
                                        <button class="btn btn-primary" id="process-csv-btn">Process File</button>
                                        <button class="btn btn-secondary" id="cancel-csv-btn">Cancel</button>
                                        <div class="btn-group" role="group">
                                            <button type="button" class="btn btn-outline-info dropdown-toggle" data-bs-toggle="dropdown">
                                                Download Template
                                            </button>
                                            <ul class="dropdown-menu">
                                                <li><a class="dropdown-item" href="#" id="download-csv-template">CSV Template</a></li>
                                                <li><a class="dropdown-item" href="#" id="download-excel-template">Excel Template</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="table-responsive mt-4">
                        <table class="table table-striped table-compact">
                            <thead>
                                <tr>
                                    <th>Registration</th>
                                    <th>Make</th>
                                    <th>Model</th>
                                    <th>Customer</th>
                                    <th>MOT Expiry</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="vehicles-table">
                                <!-- Vehicles will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Customers Page -->
                <div class="page" id="customers-page" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center">
                        <h1>Customers</h1>
                        <button class="btn btn-primary" id="add-customer-btn">
                            <i class="bi bi-plus"></i> Add Customer
                        </button>
                    </div>

                    <div class="table-responsive mt-4">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Name</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Vehicles</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="customers-table">
                                <!-- Customers will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Reminders Page -->
                <div class="page" id="reminders-page" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center">
                        <h1>Reminders</h1>
                        <div>
                            <button class="btn btn-outline-secondary me-2" id="review-mode-btn">
                                <i class="bi bi-eye"></i> Review Mode
                            </button>
                            <button class="btn btn-outline-danger me-2" id="clear-all-reminders-btn">
                                <i class="bi bi-trash"></i> Clear All
                            </button>
                            <button class="btn btn-primary" id="add-reminder-btn">
                                <i class="bi bi-plus"></i> Add Reminder
                            </button>
                        </div>
                    </div>

                    <!-- Filters and Sort -->
                    <div class="row mt-3" id="reminder-filters">
                        <div class="col-md-3">
                            <select class="form-select" id="urgency-filter">
                                <option value="">All Urgencies</option>
                                <option value="critical">Critical (Expired/Today)</option>
                                <option value="high">High (1-7 days)</option>
                                <option value="medium">Medium (8-30 days)</option>
                                <option value="low">Low (30+ days)</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="status-filter">
                                <option value="">All Statuses</option>
                                <option value="scheduled">Scheduled</option>
                                <option value="sent">Sent</option>
                                <option value="failed">Failed</option>
                                <option value="archived">Archived</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="sort-by">
                                <option value="days_asc">Days Until Expiry (Urgent First)</option>
                                <option value="days_desc">Days Until Expiry (Future First)</option>
                                <option value="registration">Registration</option>
                                <option value="make">Make/Model</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <div class="input-group">
                                <input type="text" class="form-control" id="search-vehicles" placeholder="Search vehicles...">
                                <button class="btn btn-outline-secondary" type="button" id="clear-search">
                                    <i class="bi bi-x"></i>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Bulk Actions -->
                    <div class="row mt-3" id="bulk-actions" style="display: none;">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-body">
                                    <div class="d-flex align-items-center gap-3">
                                        <span id="selected-count">0 selected</span>
                                        <button class="btn btn-success btn-sm" id="bulk-send-btn">
                                            <i class="bi bi-send"></i> Send Selected
                                        </button>
                                        <button class="btn btn-warning btn-sm" id="bulk-archive-btn">
                                            <i class="bi bi-archive"></i> Archive Selected
                                        </button>
                                        <button class="btn btn-danger btn-sm" id="bulk-delete-btn">
                                            <i class="bi bi-trash"></i> Delete Selected
                                        </button>
                                        <button class="btn btn-secondary btn-sm" id="clear-selection-btn">
                                            Clear Selection
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="table-responsive mt-4">
                        <table class="table table-striped table-compact">
                            <thead>
                                <tr>
                                    <th>
                                        <input type="checkbox" id="select-all-reminders" class="form-check-input">
                                    </th>
                                    <th>Registration</th>
                                    <th>Vehicle</th>
                                    <th>MOT Expiry</th>
                                    <th>Days Until/Since</th>
                                    <th>Urgency</th>
                                    <th>Customer</th>
                                    <th>Reminder Date</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="reminders-table">
                                <!-- Reminders will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Settings Page -->
                <div class="page" id="settings-page" style="display: none;">
                    <h1>Settings</h1>

                    <div class="row mt-4">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>Email Settings</h5>
                                </div>
                                <div class="card-body">
                                    <form id="email-settings-form">
                                        <div class="mb-3">
                                            <label for="smtp-server" class="form-label">SMTP Server</label>
                                            <input type="text" class="form-control" id="smtp-server" placeholder="smtp.example.com">
                                        </div>
                                        <div class="mb-3">
                                            <label for="smtp-port" class="form-label">SMTP Port</label>
                                            <input type="number" class="form-control" id="smtp-port" placeholder="587">
                                        </div>
                                        <div class="mb-3">
                                            <label for="smtp-username" class="form-label">SMTP Username</label>
                                            <input type="text" class="form-control" id="smtp-username" placeholder="user@example.com">
                                        </div>
                                        <div class="mb-3">
                                            <label for="smtp-password" class="form-label">SMTP Password</label>
                                            <input type="password" class="form-control" id="smtp-password">
                                        </div>
                                        <div class="mb-3">
                                            <label for="sender-email" class="form-label">Sender Email</label>
                                            <input type="email" class="form-control" id="sender-email" placeholder="garage@example.com">
                                        </div>
                                        <button type="submit" class="btn btn-primary">Save Email Settings</button>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>SMS Settings</h5>
                                </div>
                                <div class="card-body">
                                    <form id="sms-settings-form">
                                        <div class="mb-3">
                                            <label for="sms-api-url" class="form-label">SMS API URL</label>
                                            <input type="text" class="form-control" id="sms-api-url" placeholder="https://api.sms-provider.com">
                                        </div>
                                        <div class="mb-3">
                                            <label for="sms-api-key" class="form-label">SMS API Key</label>
                                            <input type="text" class="form-control" id="sms-api-key">
                                        </div>
                                        <div class="mb-3">
                                            <label for="sms-sender-id" class="form-label">SMS Sender ID</label>
                                            <input type="text" class="form-control" id="sms-sender-id" placeholder="GarageReminder">
                                        </div>
                                        <button type="submit" class="btn btn-primary">Save SMS Settings</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>Email Template</h5>
                                </div>
                                <div class="card-body">
                                    <form id="email-template-form">
                                        <div class="mb-3">
                                            <textarea class="form-control" id="email-template" rows="10"></textarea>
                                            <div class="form-text">
                                                Available placeholders: {customer_name}, {vehicle_make}, {vehicle_model}, {vehicle_registration}, {mot_expiry_date}
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Save Email Template</button>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>SMS Template</h5>
                                </div>
                                <div class="card-body">
                                    <form id="sms-template-form">
                                        <div class="mb-3">
                                            <textarea class="form-control" id="sms-template" rows="5"></textarea>
                                            <div class="form-text">
                                                Available placeholders: {customer_name}, {vehicle_make}, {vehicle_model}, {vehicle_registration}, {mot_expiry_date}
                                            </div>
                                        </div>
                                        <button type="submit" class="btn btn-primary">Save SMS Template</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row mt-4">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5>DVLA API Settings</h5>
                                </div>
                                <div class="card-body">
                                    <form id="dvla-settings-form">
                                        <div class="mb-3">
                                            <label for="dvla-client-id" class="form-label">Client ID</label>
                                            <input type="text" class="form-control" id="dvla-client-id" value="2b3911f4-55f5-4a86-a9f0-0fc02c2bff0f">
                                        </div>
                                        <div class="mb-3">
                                            <label for="dvla-client-secret" class="form-label">Client Secret</label>
                                            <input type="password" class="form-control" id="dvla-client-secret" value="rWe8Q~vhlVo7Z_fFuy~zBfAOY5BqCg_PviCwIa74">
                                        </div>
                                        <div class="mb-3">
                                            <label for="dvla-api-key" class="form-label">API Key</label>
                                            <input type="text" class="form-control" id="dvla-api-key" value="8TfF8vnU2s5sP1CRm7ij69anVlLe5SRm4cNGn9yq">
                                        </div>
                                        <button type="submit" class="btn btn-primary">Save DVLA Settings</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Job Sheets Page -->
                <div class="page" id="job-sheets-page" style="display: none;">
                    <div class="d-flex justify-content-between align-items-center">
                        <h1><i class="fas fa-file-invoice"></i> GA4 Job Sheets</h1>
                        <div>
                            <button class="btn btn-outline-secondary me-2" id="upload-job-sheets-btn">
                                <i class="bi bi-upload"></i> Upload Job Sheets
                            </button>
                            <button class="btn btn-outline-info me-2" id="link-job-data-btn">
                                <i class="bi bi-link"></i> Link Data
                            </button>
                            <button class="btn btn-outline-success me-2" id="dvla-lookup-all-btn">
                                <i class="fas fa-search"></i> DVLA Lookup All
                            </button>
                            <button class="btn btn-outline-danger me-2" id="clear-all-job-sheets-btn">
                                <i class="bi bi-trash"></i> Clear All
                            </button>
                            <button class="btn btn-primary" id="view-analytics-btn">
                                <i class="bi bi-graph-up"></i> Analytics
                            </button>
                        </div>
                    </div>

                    <!-- Job Sheets Upload Section -->
                    <div class="row mt-3" id="job-sheets-upload-section" style="display: none;">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5><i class="fas fa-cloud-upload-alt"></i> Bulk Upload GA4 Files (CSV/Excel)</h5>
                                </div>
                                <div class="card-body">
                                    <div class="mb-3">
                                        <input type="file" class="form-control" id="job-sheets-file-input" accept=".csv,.xlsx,.xls" multiple>
                                        <div class="form-text">
                                            <strong>üöÄ Multi-File GA4 Integration:</strong><br>
                                            ‚Ä¢ <strong>Select multiple files:</strong> Hold Ctrl/Cmd to select multiple files at once<br>
                                            ‚Ä¢ <strong>Supported formats:</strong> CSV (.csv) and Excel (.xlsx, .xls)<br>
                                            ‚Ä¢ <strong>Auto-detection:</strong> System automatically detects file types (customers, vehicles, job sheets, etc.)<br>
                                            ‚Ä¢ <strong>Smart processing:</strong> Files processed in optimal order for data linking<br>
                                            ‚Ä¢ <strong>DVLA integration:</strong> Automatic vehicle lookup during processing<br>
                                            ‚Ä¢ <strong>Duplicate handling:</strong> Updates existing records, creates new ones as needed
                                        </div>
                                    </div>

                                    <!-- File List Display -->
                                    <div id="selected-files-list" class="mb-3" style="display: none;">
                                        <h6><i class="fas fa-list"></i> Selected Files:</h6>
                                        <div id="files-preview" class="border rounded p-2 bg-light">
                                            <!-- Selected files will be shown here -->
                                        </div>
                                    </div>

                                    <!-- Processing Options -->
                                    <div class="row mb-3">
                                        <div class="col-md-6">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="auto-dvla-lookup" checked>
                                                <label class="form-check-label" for="auto-dvla-lookup">
                                                    <i class="fas fa-search"></i> Auto DVLA Lookup
                                                </label>
                                            </div>
                                        </div>
                                        <div class="col-md-6">
                                            <div class="form-check">
                                                <input class="form-check-input" type="checkbox" id="auto-link-data" checked>
                                                <label class="form-check-label" for="auto-link-data">
                                                    <i class="fas fa-link"></i> Auto Link Data
                                                </label>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Progress Bar -->
                                    <div id="upload-progress" class="mb-3" style="display: none;">
                                        <div class="d-flex justify-content-between mb-1">
                                            <span id="progress-text">Processing files...</span>
                                            <span id="progress-percentage">0%</span>
                                        </div>
                                        <div class="progress">
                                            <div class="progress-bar progress-bar-striped progress-bar-animated" id="progress-bar" role="progressbar" style="width: 0%"></div>
                                        </div>
                                    </div>

                                    <div class="d-flex gap-2">
                                        <button class="btn btn-primary" id="process-job-sheets-btn">
                                            <i class="fas fa-rocket"></i> Process All Files
                                        </button>
                                        <button class="btn btn-secondary" id="cancel-job-sheets-btn">Cancel</button>
                                        <button class="btn btn-outline-info" id="clear-files-btn" style="display: none;">
                                            <i class="fas fa-times"></i> Clear Selection
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Analytics Summary -->
                    <div class="row mt-4" id="job-sheets-analytics">
                        <div class="col-md-3">
                            <div class="stat-card hover-glow">
                                <div class="stat-number" id="total-jobs-count">0</div>
                                <div class="stat-label">
                                    <i class="fas fa-file-invoice"></i> Total Jobs
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card hover-glow">
                                <div class="stat-number" id="total-revenue">¬£0</div>
                                <div class="stat-label">
                                    <i class="fas fa-pound-sign"></i> Total Revenue
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card hover-glow">
                                <div class="stat-number" id="mot-jobs-count">0</div>
                                <div class="stat-label">
                                    <i class="fas fa-car"></i> MOT Jobs
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="stat-card hover-glow">
                                <div class="stat-number" id="payment-rate">0%</div>
                                <div class="stat-label">
                                    <i class="fas fa-credit-card"></i> Payment Rate
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Filters -->
                    <div class="row mt-3" id="job-sheets-filters">
                        <div class="col-md-3">
                            <input type="text" class="form-control" id="search-customer" placeholder="Search customer...">
                        </div>
                        <div class="col-md-3">
                            <input type="text" class="form-control" id="search-vehicle-reg" placeholder="Search registration...">
                        </div>
                        <div class="col-md-2">
                            <input type="date" class="form-control" id="date-from" placeholder="From date">
                        </div>
                        <div class="col-md-2">
                            <input type="date" class="form-control" id="date-to" placeholder="To date">
                        </div>
                        <div class="col-md-2">
                            <button class="btn btn-outline-secondary" id="clear-job-filters">
                                <i class="bi bi-x"></i> Clear
                            </button>
                        </div>
                    </div>

                    <div class="table-responsive mt-4">
                        <table class="table table-striped table-compact">
                            <thead>
                                <tr>
                                    <th>Doc No</th>
                                    <th>Date</th>
                                    <th>Customer</th>
                                    <th>Vehicle</th>
                                    <th>Registration</th>
                                    <th>Total</th>
                                    <th>Status</th>
                                    <th>Links</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="job-sheets-table">
                                <!-- Job sheets will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Add/Edit Vehicle Modal -->
    <div class="modal fade" id="vehicle-modal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="vehicle-modal-title">Add Vehicle</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="vehicle-form">
                        <input type="hidden" id="vehicle-id">
                        <div class="mb-3">
                            <label for="vehicle-registration" class="form-label">Registration</label>
                            <div class="input-group">
                                <input type="text" class="form-control" id="vehicle-registration" required>
                                <button class="btn btn-outline-secondary" type="button" id="lookup-vehicle-btn">Lookup</button>
                            </div>
                            <div class="mt-2">
                                <input type="file" class="form-control" id="ocr-image-upload" accept="image/*" style="display: none;">
                                <button class="btn btn-outline-primary btn-sm" type="button" id="upload-image-btn">
                                    <i class="bi bi-camera"></i> Upload Image for OCR
                                </button>
                                <small class="form-text text-muted">Upload an image of a registration plate to extract the number automatically</small>
                            </div>
                        </div>
                        <div class="mb-3">
                            <label for="vehicle-make" class="form-label">Make</label>
                            <input type="text" class="form-control" id="vehicle-make">
                        </div>
                        <div class="mb-3">
                            <label for="vehicle-model" class="form-label">Model</label>
                            <input type="text" class="form-control" id="vehicle-model">
                        </div>
                        <div class="mb-3">
                            <label for="vehicle-color" class="form-label">Color</label>
                            <input type="text" class="form-control" id="vehicle-color">
                        </div>
                        <div class="mb-3">
                            <label for="vehicle-year" class="form-label">Year</label>
                            <input type="number" class="form-control" id="vehicle-year">
                        </div>
                        <div class="mb-3">
                            <label for="vehicle-mot-expiry" class="form-label">MOT Expiry</label>
                            <input type="date" class="form-control" id="vehicle-mot-expiry">
                        </div>
                        <div class="mb-3">
                            <label for="vehicle-customer" class="form-label">Customer</label>
                            <select class="form-select" id="vehicle-customer">
                                <option value="">Select Customer</option>
                                <!-- Customers will be loaded here -->
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="save-vehicle-btn">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Customer Modal -->
    <div class="modal fade" id="customer-modal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="customer-modal-title">Add Customer</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="customer-form">
                        <input type="hidden" id="customer-id">
                        <div class="mb-3">
                            <label for="customer-name" class="form-label">Name</label>
                            <input type="text" class="form-control" id="customer-name" required>
                        </div>
                        <div class="mb-3">
                            <label for="customer-email" class="form-label">Email</label>
                            <input type="email" class="form-control" id="customer-email">
                        </div>
                        <div class="mb-3">
                            <label for="customer-phone" class="form-label">Phone</label>
                            <input type="tel" class="form-control" id="customer-phone">
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="save-customer-btn">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Reminder Modal -->
    <div class="modal fade" id="reminder-modal" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reminder-modal-title">Add Reminder</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="reminder-form">
                        <input type="hidden" id="reminder-id">
                        <div class="mb-3">
                            <label for="reminder-vehicle" class="form-label">Vehicle</label>
                            <select class="form-select" id="reminder-vehicle" required>
                                <option value="">Select Vehicle</option>
                                <!-- Vehicles will be loaded here -->
                            </select>
                        </div>
                        <div class="mb-3">
                            <label for="reminder-date" class="form-label">Reminder Date</label>
                            <input type="date" class="form-control" id="reminder-date" required>
                        </div>
                        <div class="mb-3">
                            <label for="reminder-status" class="form-label">Status</label>
                            <select class="form-select" id="reminder-status">
                                <option value="scheduled">Scheduled</option>
                                <option value="sent">Sent</option>
                                <option value="failed">Failed</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="save-reminder-btn">Save</button>
                </div>
            </div>
        </div>
    </div>

    <!-- CSV Results Modal -->
    <div class="modal fade" id="csv-results-modal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">CSV Upload Results</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="csv-results-content">
                        <!-- Results will be populated here -->
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Vehicle Details Modal -->
    <div class="modal fade" id="vehicle-details-modal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="vehicle-details-title">Vehicle Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <!-- Vehicle Information -->
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="bi bi-car-front"></i> Vehicle Information (Garage Records)</h6>
                                </div>
                                <div class="card-body" id="vehicle-info">
                                    <!-- Vehicle data will be populated here -->
                                </div>
                            </div>
                        </div>

                        <!-- Customer Information -->
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="bi bi-person"></i> Customer Information</h6>
                                </div>
                                <div class="card-body" id="customer-info">
                                    <!-- Customer data will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- DVLA Information -->
                    <div class="row">
                        <div class="col-12">
                            <div class="card mb-3">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="bi bi-shield-check"></i> DVLA Official Data</h6>
                                </div>
                                <div class="card-body" id="dvla-info">
                                    <!-- DVLA data will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- MOT History -->
                    <div class="row">
                        <div class="col-12">
                            <div class="card mb-3">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="fas fa-history"></i> DVLA MOT History</h6>
                                </div>
                                <div class="card-body" id="vehicle-mot-history">
                                    <div class="text-center">
                                        <div class="ai-loading"></div>
                                        <p class="mt-2">Loading MOT history from DVLA...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- MOT Reminders -->
                    <div class="row">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h6 class="mb-0"><i class="bi bi-calendar-check"></i> MOT Reminders</h6>
                                    <button class="btn btn-sm btn-primary" id="add-reminder-for-vehicle">
                                        <i class="bi bi-plus"></i> Add Reminder
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-sm">
                                            <thead>
                                                <tr>
                                                    <th>Reminder Date</th>
                                                    <th>Status</th>
                                                    <th>Created</th>
                                                    <th>Sent</th>
                                                    <th>Actions</th>
                                                </tr>
                                            </thead>
                                            <tbody id="vehicle-reminders-table">
                                                <!-- Reminders will be populated here -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="edit-vehicle-from-details">Edit Vehicle</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Reminder Details Modal -->
    <div class="modal fade" id="reminder-details-modal" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="reminder-details-title">Reminder Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div class="row">
                        <!-- Reminder Information -->
                        <div class="col-md-12">
                            <div class="card mb-3">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="bi bi-calendar-check"></i> Reminder Information</h6>
                                </div>
                                <div class="card-body" id="reminder-details-info">
                                    <!-- Reminder data will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <!-- Vehicle Information -->
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="bi bi-car-front"></i> Vehicle Information</h6>
                                </div>
                                <div class="card-body" id="reminder-vehicle-info">
                                    <!-- Vehicle data will be populated here -->
                                </div>
                            </div>
                        </div>

                        <!-- Customer Information -->
                        <div class="col-md-6">
                            <div class="card mb-3">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="bi bi-person"></i> Customer Information</h6>
                                </div>
                                <div class="card-body" id="reminder-customer-info">
                                    <!-- Customer data will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- DVLA Information -->
                    <div class="row">
                        <div class="col-12">
                            <div class="card mb-3">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="bi bi-shield-check"></i> DVLA Official Data</h6>
                                </div>
                                <div class="card-body" id="reminder-dvla-info">
                                    <!-- DVLA data will be populated here -->
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- MOT History -->
                    <div class="row">
                        <div class="col-12">
                            <div class="card mb-3">
                                <div class="card-header">
                                    <h6 class="mb-0"><i class="fas fa-history"></i> DVLA MOT History</h6>
                                </div>
                                <div class="card-body" id="reminder-mot-history">
                                    <div class="text-center">
                                        <div class="ai-loading"></div>
                                        <p class="mt-2">Loading MOT history from DVLA...</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-warning" id="edit-reminder-from-details">
                        <i class="bi bi-pencil"></i> Edit Reminder
                    </button>
                    <button type="button" class="btn btn-success" id="send-reminder-from-details">
                        <i class="bi bi-send"></i> Send Reminder
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Notifications -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3">
        <div id="toast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <strong class="me-auto" id="toast-title">Notification</strong>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body" id="toast-message">
                <!-- Toast message will be set dynamically -->
            </div>
        </div>
    </div>

    <!-- Theme Toggle Button -->
    <button class="theme-toggle" id="theme-toggle" title="Toggle Light/Dark Theme">
        <i class="fas fa-sun"></i>
    </button>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="/js/main.js"></script>
</body>
</html>
